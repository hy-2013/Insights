---
{"dg-publish":true,"permalink":"/030 PKV/AI/LLM/ChatSum项目/","tags":["#LLM"]}
---

## 1. Pipeline


1. 收集聊天记录：
	- 从群聊中获取每天的聊天记录并保存下来，以便后续处理和分析。
2. 数据清洗：
	- 清洗聊天记录，去除无关信息（如表情符号、链接、图片等）。
3. 预处理
	- 将聊天记录按照天（或指定时间区间）做分组，组内按时间排序。
	- 将每条聊天记录转化为SFT可用的格式
4. 话题识别：
	- 根据聊天内容，识别和提取出每个讨论的话题。
	- 对相似或相关的话题进行合并，以减少重复和冗余。
5. 话题分类：
	- 将每个识别出的话题进行分类，例如工作、娱乐、技术、健康等。
	- 根据群聊的特点和需求，可以自定义适合的话题分类（技术、产品、QA、汇报、TODO等）。
6. 话题摘要生成：
	- 对于每个话题，根据相关的聊天记录生成简要的摘要。
	- 摘要应该包含主要观点、讨论要点和重要决策。
7. 汇总和报告：
	- 将每天的摘要和重要信息整合到一个汇总报告中。
	- 报告可以采用适合的格式，如文本、电子表格或演示文稿。

## 2. FT数据格式
### 2.1 综合任务
```json
[
    {
        "instruction": "你是一个优秀的对话聊天助手。基于输入的所有多轮聊天记录，你需要逐步完成如下任务，首先，将多轮聊天记录归纳出几个主要的话题，然后对每次聊天做话题分类，最后给出针对每个话题的总结.",
        "input": "<|im_start|>A: 最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？<|im_end|>\n<|im_start|>B: 我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。<|im_end|>\n<|im_start|>A: 但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？<|im_end|>\n<|im_start|>C: 听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。<|im_end|>\n<|im_start|>A: 我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。<|im_end|>\n<|im_start|>B: 青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。<|im_end|>\n<|im_start|>A: 妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？<|im_end|>\n<|im_start|>D: 你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。<|im_end|>\n<|im_start|>A: 近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。<|im_end|>\n<|im_start|>E: 我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。<|im_end|>\n<|im_start|>A: 妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。<|im_end|>\n<|im_start|>B: 很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。<|im_end|>\n<|im_start|>A: 有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。<|im_end|>\n<|im_start|>B: 家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。<|im_end|>\n<|im_start|>A: 我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。<|im_end|>\n<|im_start|>D: 不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。<|im_end|>\n<|im_start|>A: 非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。<|im_end|>\n<|im_start|>E: 很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决<|im_end|>\n",
        "output": "根据这段多轮对话，我们可以归纳出以下主要的话题：\n1.求助者与母亲的矛盾和冲突\n2.求助者如何更好地管理自己的情绪\n3.求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑\n4.求助者对母亲的担忧与理解\n\n以下是对每次对话的分类：\n\n1.\"求助者：最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？\" - 话题1\n2.\"支持者：我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。\" - 话题1\n3.\"求助者：但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？\" - 话题1\n4.\"支持者：听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。\" - 话题1\n5.\"求助者：我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。\" - 话题2\n6.\"支持者：青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。\" - 话题2\n7.\"求助者：妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？\" - 话题1\n8.\"支持者：你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。\" - 话题1\n9.\"求助者：近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。\" - 话题3\n10.\"支持者：我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。\" - 话题3\n11.\"求助者：妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。\" - 话题1\n12.\"支持者：很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。\" - 话题1\n13.\"求助者：有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。\" - 话题3\n14.\"支持者：家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。\" - 话题3\n15.\"求助者：我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。\" - 话题4\n16.\"支持者：不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。\" - 话题4\n17.\"求助者：非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。\" - 话题1\n18.\"支持者：很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决。\" - 话题4\n\n以下是针对每个话题的总结：\n\n1.**话题1 - 求助者与母亲的矛盾和冲突**：对话中反映出求助者与母亲之间存在一些沟通难题，包括信任问题、表达方式的不适应、误解等。为解决这些问题，支持者建议求助者尝试不同的沟通方式，真实地表达自己的感受，以及避免误解的发生。\n\n2.**话题2 - 求助者如何更好地管理自己的情绪**：求助者表示在与母亲的冲突中，经常难以控制自己的情绪。为此，支持者建议求助者寻找一些方法来缓解情绪，例如听音乐或读书。\n\n3.**话题3 - 求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑**：求助者表达了对于学业的压力和家务分配不均的不满，以及对于个人兴趣（游戏）的追求。支持者建议求助者与母亲沟通，表达自己的困扰和需求，寻求理解和支持。\n\n4.**话题4 - 求助者对母亲的担忧与理解**：求助者对母亲的担忧和理解，体现出他对母亲的关心和爱。支持者建议求助者表达自己的这些想法，同时也提醒他关心和照顾母亲也是他的责任。"
    },
    {
        "instruction": "xxx",
        "input": "<|im_start|><|im_end|>\n",
        "output": "xxx"
    },
…
    
]
```
Alpaca格式说明：
- instruction: 字符串，描述模型需要执行的任务;
- input: 字符串(可选)，为每个任务提供输入上下文信息
- output: 字符串，人工标注的内容，表示模型应当产生的输出内容
- 例如：当“instruction” 为”总结下面文章“，”input“ 为文章内容时，”output“ 为文章摘要。

#### 简化版本：
```json
[
    {
        "instruction": "你是一个优秀的对话聊天助手。基于所有多轮聊天记录，你需要逐步完成如下任务，首先，将聊天记录归纳出最多5个简洁又主要的话题，然后针对每个话题给出总结和要点。提示：`<|im_start|>`代表每条聊天的开始，`<|im_end|>\n`代表每条聊天的结束",
        "input": "<|im_start|>A: 最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？<|im_end|>\n<|im_start|>B: 我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。<|im_end|>\n<|im_start|>A: 但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？<|im_end|>\n<|im_start|>C: 听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。<|im_end|>\n<|im_start|>A: 我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。<|im_end|>\n<|im_start|>B: 青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。<|im_end|>\n<|im_start|>A: 妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？<|im_end|>\n<|im_start|>D: 你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。<|im_end|>\n<|im_start|>A: 近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。<|im_end|>\n<|im_start|>E: 我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。<|im_end|>\n<|im_start|>A: 妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。<|im_end|>\n<|im_start|>B: 很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。<|im_end|>\n<|im_start|>A: 有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。<|im_end|>\n<|im_start|>B: 家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。<|im_end|>\n<|im_start|>A: 我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。<|im_end|>\n<|im_start|>D: 不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。<|im_end|>\n<|im_start|>A: 非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。<|im_end|>\n<|im_start|>E: 很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决<|im_end|>\n",
        "output": "话题1：与妈妈的矛盾和沟通问题\n总结：聊天记录中，A表达了与妈妈之间的矛盾和沟通困难。B、C、D和E都建议A尝试不同的沟通方式，如平静地提出自己的疑惑和不满，写信，找一个中立的人协调谈话，或者直接表达自己的感受。\n\n话题2：情绪控制问题\n总结：A表示自己在与妈妈的争端中，往往无法控制自己的情绪。B建议A可以尝试找些方法来缓解情绪，如听音乐、看书等。\n\n话题3：妈妈的担忧和压力\n总结：A表示妈妈总是为自己的学业和未来担忧，这让A感到压力。E建议A可以尝试和妈妈沟通，表明自己的压力和困惑，寻求她的理解和支持。\n\n话题4：家务分工问题\n总结：A觉得妈妈在家务分工上不公平，总是让A做家务和学习。B建议A可以和妈妈商量，建立更合理的分工方式。\n\n话题5：离家出走的想法\n总结：A有时会想，如果自己不在妈妈身边，妈妈就会轻松一些。D建议A不要把这些想法压在心里，而是应该和妈妈沟通，寻求她的理解和支持。\n\n"
    },
    {
        "instruction": "xxx",
        "input": "<|im_start|><|im_end|>\n",
        "output": "xxx"
    },
…
    
]
```
样本构建：`Instructinon`增加`，聊天记录均在"""内。`后和`input`拼接，输入给chatgpt，得到`output`。
### 2.2 话题归纳
```json
[
    {
        "instruction": "你是一个优秀的对话聊天助手。将输入的多轮聊天记录归纳为几个主要的话题.",
        "input": "<|im_start|>A: 最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？<|im_end|>\n<|im_start|>B: 我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。<|im_end|>\n<|im_start|>A: 但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？<|im_end|>\n<|im_start|>C: 听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。<|im_end|>\n<|im_start|>A: 我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。<|im_end|>\n<|im_start|>B: 青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。<|im_end|>\n<|im_start|>A: 妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？<|im_end|>\n<|im_start|>D: 你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。<|im_end|>\n<|im_start|>A: 近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。<|im_end|>\n<|im_start|>E: 我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。<|im_end|>\n<|im_start|>A: 妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。<|im_end|>\n<|im_start|>B: 很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。<|im_end|>\n<|im_start|>A: 有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。<|im_end|>\n<|im_start|>B: 家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。<|im_end|>\n<|im_start|>A: 我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。<|im_end|>\n<|im_start|>D: 不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。<|im_end|>\n<|im_start|>A: 非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。<|im_end|>\n<|im_start|>E: 很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决<|im_end|>\n",
        "output": "根据这段多轮对话，我们可以归纳出以下主要的话题：\n1.求助者与母亲的矛盾和冲突\n2.求助者如何更好地管理自己的情绪\n3.求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑\n4.求助者对母亲的担忧与理解\n\n"
    },
    {
        "instruction": "xxx",
        "input": "<|im_start|><|im_end|>\n",
        "output": "xxx"
    },
…
    
]
```

### 2.3 话题分类
```json
[
    {
        "instruction": "你是一个优秀的对话聊天助手。以下多轮聊天的话题包括：1.求助者与母亲的矛盾和冲突。2.求助者如何更好地管理自己的情绪。3.求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑。4.求助者对母亲的担忧与理解。请对每条聊天记录做话题分类。",
        "input": "<|im_start|>A: 最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？<|im_end|>\n<|im_start|>B: 我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。<|im_end|>\n<|im_start|>A: 但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？<|im_end|>\n<|im_start|>C: 听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。<|im_end|>\n<|im_start|>A: 我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。<|im_end|>\n<|im_start|>B: 青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。<|im_end|>\n<|im_start|>A: 妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？<|im_end|>\n<|im_start|>D: 你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。<|im_end|>\n<|im_start|>A: 近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。<|im_end|>\n<|im_start|>E: 我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。<|im_end|>\n<|im_start|>A: 妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。<|im_end|>\n<|im_start|>B: 很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。<|im_end|>\n<|im_start|>A: 有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。<|im_end|>\n<|im_start|>B: 家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。<|im_end|>\n<|im_start|>A: 我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。<|im_end|>\n<|im_start|>D: 不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。<|im_end|>\n<|im_start|>A: 非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。<|im_end|>\n<|im_start|>E: 很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决<|im_end|>\n",
        "output": "以下是对每次对话的分类：\n\n1.\"求助者：最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？\" - 话题1\n2.\"支持者：我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。\" - 话题1\n3.\"求助者：但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？\" - 话题1\n4.\"支持者：听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。\" - 话题1\n5.\"求助者：我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。\" - 话题2\n6.\"支持者：青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。\" - 话题2\n7.\"求助者：妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？\" - 话题1\n8.\"支持者：你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。\" - 话题1\n9.\"求助者：近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。\" - 话题3\n10.\"支持者：我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。\" - 话题3\n11.\"求助者：妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。\" - 话题1\n12.\"支持者：很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。\" - 话题1\n13.\"求助者：有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。\" - 话题3\n14.\"支持者：家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。\" - 话题3\n15.\"求助者：我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。\" - 话题4\n16.\"支持者：不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。\" - 话题4\n17.\"求助者：非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。\" - 话题1\n18.\"支持者：很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决。\" - 话题4\n\n"
    },
    {
        "instruction": "xxx",
        "input": "<|im_start|><|im_end|>\n",
        "output": "xxx"
    },
…
    
]
```

### 2.4 话题总结
```json
[
    {
        "instruction": "你是一个优秀的对话聊天助手。以下多轮聊天的话题包括：1.求助者与母亲的矛盾和冲突。2.求助者如何更好地管理自己的情绪。3.求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑。4.求助者对母亲的担忧与理解。请基于所有聊天记录给出针对每个话题的总结.",
        "input": "<|im_start|>A: 最近总是和妈妈闹矛盾，但是又不知道该怎么办，能帮我想想办法吗？<|im_end|>\n<|im_start|>B: 我了解你的情况，跟亲人之间经常会产生矛盾是很常见的现象。你不妨试试和妈妈沟通一下，平静地提出自己的疑惑和不满，看看能否解决矛盾。<|im_end|>\n<|im_start|>A: 但是每次我和妈妈说话，总会起争端，她总是让我感觉她不信任我，我该怎么办呢？<|im_end|>\n<|im_start|>C: 听起来你和妈妈之间的交流很困难，你可以试试换个方式和她沟通，比如写信或者找一个更加中立的人一起协调谈话，让大家都有更好的表达机会。<|im_end|>\n<|im_start|>A: 我特别讨厌和她吵架，可是我有时候就是自制力不够，很难抑制自己的情绪。<|im_end|>\n<|im_start|>B: 青春期的年轻人情绪波动很大很正常，但是你可以试试找些方法来缓解情绪，比如听听音乐、看看书等等，使自己情绪更稳定。<|im_end|>\n<|im_start|>A: 妈妈总是很为我担心，但是我感觉她的表达方式让我很不舒服，怎么办？<|im_end|>\n<|im_start|>D: 你可以试着跟妈妈提出你的感受，说出你觉得她的表达方式不太适合你，看看一起可以找到一个更好的沟通方式。<|im_end|>\n<|im_start|>A: 近期我迷上了游戏，可是妈妈总是担心我的学业，会经常跟我谈中考和未来，我也很焦虑。<|im_end|>\n<|im_start|>E: 我能理解你的压力，但是你的妈妈对你的学业担忧也是很正常的。你可以试着和妈妈沟通一下，表明自己的压力和困惑，寻求她的理解和支持。<|im_end|>\n<|im_start|>A: 妈妈总是说我顶嘴顶的不好，可是我并没有说过什么不好的话，这些误解让我很难受。<|im_end|>\n<|im_start|>B: 很抱歉听到这些误解带给你的困扰，你可以试着和妈妈沟通，表明你没有说过不好的话，避免误解的发生。<|im_end|>\n<|im_start|>A: 有时候我觉得妈妈很不公平，总是让我做家务和学习，而她却不怎么做，这让我很不满意。<|im_end|>\n<|im_start|>B: 家务和学习的确是每个人都需要承担的责任，但是你可以跟妈妈商量一下，建立更合理的分工方式，让大家的负担更加均衡。<|im_end|>\n<|im_start|>A: 我有时候会想，如果我不在妈妈身边，她就不会那么疲惫与辛苦了，是不是我应该离开她，这样她就会开心一些。<|im_end|>\n<|im_start|>D: 不要把这些想法一直压在心里，试着跟她好好沟通，说说你的担心和顾虑，寻求她的支持和理解。离开并不会解决问题，关心和照顾妈妈也是你的责任之一。<|im_end|>\n<|im_start|>A: 非常感谢你的耐心倾听和建议，我会好好尝试和妈妈沟通，解决我们之间的矛盾。<|im_end|>\n<|im_start|>E: 很高兴能帮助你，你已经迈出了寻求帮助的第一步，接下来只要继续坚持下去，相信问题一定会得到好的解决<|im_end|>\n",
        "output": "以下是针对每个话题的总结：\n\n1.**话题1 - 求助者与母亲的矛盾和冲突**：对话中反映出求助者与母亲之间存在一些沟通难题，包括信任问题、表达方式的不适应、误解等。为解决这些问题，支持者建议求助者尝试不同的沟通方式，真实地表达自己的感受，以及避免误解的发生。\n\n2.**话题2 - 求助者如何更好地管理自己的情绪**：求助者表示在与母亲的冲突中，经常难以控制自己的情绪。为此，支持者建议求助者寻找一些方法来缓解情绪，例如听音乐或读书。\n\n3.**话题3 - 求助者在学业、家务和个人兴趣（游戏）之间的压力和焦虑**：求助者表达了对于学业的压力和家务分配不均的不满，以及对于个人兴趣（游戏）的追求。支持者建议求助者与母亲沟通，表达自己的困扰和需求，寻求理解和支持。\n\n4.**话题4 - 求助者对母亲的担忧与理解**：求助者对母亲的担忧和理解，体现出他对母亲的关心和爱。支持者建议求助者表达自己的这些想法，同时也提醒他关心和照顾母亲也是他的责任。"
    },
    {
        "instruction": "xxx",
        "input": "<|im_start|><|im_end|>\n",
        "output": "xxx"
    },
…
    
]
```


### Modelhub开源model调研

1. 10轮对话：
	1. `Llama-2-13b-chat-hf`和`baichun-13b-chat`，`chatglm2-6b`略差，其他不可用。

2. Chatglm2：[Site Unreachable](https://ai.intra.xiaojukeji.com/modelhub/detail?id=DCSum/chatglm2-6b-1696670455-3783&type=datasets&icon=dataset&projectName=DCSum)
	1. Context Length短，只能summary最后几轮chat
	2. 返回空：temperature的原因，"temperature":0.0001,有问题 "temperature":0.01,没问题
	3. SP TOken很重要：`[Round 1]\n\n问：xxx \n\n答：`

### 闭源模型调研
1. gpt35（通过不断改进prompt解决大多数）
	1. 问题：
		1. 语义理解问题（尤其是有上下文语义关联时）
		2. 生成内容重复问题
		3. 指令准从问题（没有5个话题也要生成5个）
		4. 总结的不够精简，导致截断：甚至没有做话题总结，原文输出，被截断
		5. 极少情况有hallucination问题：不知道某个话题哪儿来的
		6. API服务稳定性问题
2. prompt迭代：
```
# 中间某版
你是一个优秀的对话聊天助手。基于所有多轮聊天记录，你需要逐步完成如下任务，首先，将聊天记录归纳出最多5个主要的话题，话题名称尽量简洁；然后针对每个话题给出总结和要点，尽量给出每个人的观点或态度。提示：`<|im_start|>`代表每条聊天的开始，`<|im_end|>\n`代表每条聊天的结束，聊天记录均在"""内。

# 最终版
你是一个优秀的对话聊天助手。基于所有多轮聊天记录，你需要逐步完成如下任务，首先，将聊天记录的内容归纳出2-5个核心话题（话题名称要简洁），并简洁的概括出每个人的观点或态度；最后针对每个话题给出总结和要点。提示：`<|im_start|>`代表每条聊天的开始，`<|im_end|>\n`代表每条聊天的结束。
```



## TODO
1. [x] gpt4或claude API，构建summary数据 ✅ 2023-09-26
2. [ ] [GitHub - HqWu-HITCS/Awesome-Chinese-LLM: 整理开源的中文大语言模型，以规模较小、可私有化部署、训练成本较低的模型为主，包括底座模型，垂直领域微调及应用，数据集与教程等。](https://github.com/HqWu-HITCS/Awesome-Chinese-LLM)
3. [ ] 重要信息、任务和问题提取：将提取出的信息进行整理和归档，以便后续任务跟进和问题处理。
4. [ ] 表情符号、链接、图片 信息识别
5. [ ] 报告发送：我需要将生成的报告发送给你。我可以通过电子邮件，短信，或者其他你指定的方式来发送这份报告。
6. [ ] 升级为Agent信息助手：自动「问题接收」、自动「系统迭代」、自动「沟通」，甚至和工作Agent联动自动「完成工作内容」。


---
开发TOOD
@朝立
1. [x] 主要闭源（国内和国外）的summary对比 ✅ 2023-10-04
2. [ ] 开源模型（modelhub里和主流开源的）的summary对比
	1. [ ] modelhub返回都是\n的原因
3. [x] 写一个便于对比看case的小框架 ✅ 2023-10-04
4. [ ] 调研基于SFT最好的方案
	1. [ ] self-instruction，llama2、baichuan、千问等tech report
5. [x] gpt35 summary问题 ✅ 2023-10-07
6. [ ] chat做chunk时的语义切割问题

 @志国
1. [ ] 丰富测试和FT Instruction数据（质量、数量、多样性的多轮多人chat）
2. [ ] 基于openai的chat summary demo流程开发
3. [ ] DSL 语言（mermaid、plantuml）xmind式summary可视化
